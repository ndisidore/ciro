[tools]
go = "1.23"

[tasks.build]
description = "Build all packages"
run = "go build ./..."

[tasks.test]
description = "Run all tests"
run = "go test -race ./..."

[tasks.vet]
description = "Run go vet"
run = "go vet ./..."

[tasks.lint]
description = "Run golangci-lint"
run = "golangci-lint run"

[tasks.fmt]
description = "Format code"
run = "gofmt -w ."

[tasks."fmt:check"]
description = "Check formatting"
run = 'test -z "$(gofmt -l .)"'

[tasks.validate]
description = "Validate a KDL pipeline file"
run = "go run ./cmd/ciro validate"

[tasks.run]
description = "Run a KDL pipeline"
run = "go run ./cmd/ciro run"

[tasks.ci]
description = "Run all CI checks"
depends = ["fmt:check", "vet", "lint", "test"]
